#pragma once
#include "ial.h"
#include "scaner.h"

#define VELIKOST_TABULKY 18

extern tToken *vysExp;

static const char PrecedencniTabulka[VELIKOST_TABULKY][VELIKOST_TABULKY]={

/*          */{'Q','+','-','*','/','<','>','o','g','e','n','i','d','s','p','(',')','$'},
/*	   +     */{'+','>','>','<','<','>','>','>','>','>','>','<','<','<','<','<','>','>'},
/*	   -     */{'-','>','>','<','<','>','>','>','>','>','>','<','<','-','<','<','>','>'},
/*	   *     */{'*','>','>','>','>','>','>','>','>','>','>','<','<','-','<','<','>','>'},
/*	   /     */{'/','>','>','>','>','>','>','>','>','>','>','<','<','-','<','<','>','>'},
/*	   <     */{'<','<','<','<','<','-','-','-','-','-','-','<','<','-','<','<','>','>'},
/*	   >     */{'>','<','<','<','<','-','-','-','-','-','-','<','<','-','<','<','>','>'},
/*	   <=    */{'o','<','<','<','<','-','-','-','-','-','-','<','<','-','<','<','>','>'},
/*	   >=    */{'g','<','<','<','<','-','-','-','-','-','-','<','<','-','<','<','>','>'},
/*	   ==    */{'e','<','<','<','<','-','-','-','-','-','-','<','<','-','<','<','>','>'},
/*	   !=    */{'n','<','<','<','<','-','-','-','-','-','-','<','<','-','<','<','>','>'},
/*	   int   */{'i','>','>','>','>','>','>','>','>','>','>','-','-','-','-','-','>','>'},
/*    double*/{'d','>','>','>','>','>','>','>','>','>','>','-','-','-','-','-','>','>'},
/*    string*/{'s','>','>','>','>','>','>','>','>','>','>','-','-','-','-','-','>','>'},
/*	   i     */{'p','>','>','>','>','>','>','>','>','>','>','-','-','-','>','<','>','>'},
/*	   (     */{'(','<','<','<','<','<','<','<','<','<','<','<','<','<','<','<','=','>'},
/*	   )     */{')','>','>','>','>','>','>','>','>','>','>','-','<','-','>','>','>','>'},
/*	   $     */{'$','<','<','<','<','<','<','<','<','<','<','<','<','<','<','<','-','P'},
};
typedef struct expStack
{
   char data;
   struct expStack *next;

} tExpStack;


typedef struct valueStack
{
   state typ;
   union 
   {
      int intValue;
      double doubleValue;
      char *stringValue;
   }value;
   tVar *var;
   struct valueStack *next;

}tValueStack;

typedef enum{
   UNDEF,
   PL,
   MIN,
   MUL,
   DIV,
   E_LESS = 203,
} operation;

enum
{
   PUSH_NEW,PUSH_STOP,
   PUSH_END,PUSH_REDUCE,
};

int processing_expression(bool logic);